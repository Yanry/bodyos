# Evaluation and Scoring Flow

**类型**: Feature  
**版本**: v1.0  
**状态**: 待实现  
**最后更新**: 2026-02-05

---

## Changelog

### v1.0 - 2026-02-05
- ✅ 接收完整功能规格文档
- 定义双模式检测系统（无引导评估 vs 引导改进）
- 定义分数页布局与问题卡片逻辑
- 定义打卡图生成规则
- 定义路由逻辑（根据分数切换路径）

---

## Implementation Log

### 理解要点

1. **双模式逻辑**:
   - **Mode 1 (Baseline)**: 纯净录制，无实时反馈，旨在获取真实数据。
   - **Mode 2 (Improvement)**: 强干预录制，包含要点回顾和实时语音/视觉引导。
   - 模式切换触发点：分数页的「尝试改进」按钮。

2. **分数页核心组件**:
   - **可视化诊断**: 需要在关键帧截图上叠加骨骼（MediaPipe）并进行视觉标注。
   - **动态列表**: 问题卡片根据严重程度排序，文案关联 Tone 层规则。

3. **路由规则**:
   - 分数阈值 70 分作为分水岭，引导至不同的后续路径（改进 vs 意识训练）。

4. **图形生成**:
   - 需要 Canvas 或 HTML2Canvas 等技术生成 1080x1920 的打卡图并处理保存/分享。

### 实现计划

1. **状态管理**:
   - 使用 `evaluation_mode` ("baseline" | "guidance") 驱动相机行为。
2. **分数页开发**:
   - `ScoreDashboard`: 分数和日期展示。
   - `DiagnosticFrame`: 带有骨骼叠加的截图展示组件。
   - `ProblemCardList`: 基于严重程度排序的问题列表。
3. **功能模块**:
   - `PosterGenerator`: 实现打卡图合成逻辑。
   - `EvaluationRouter`: 处理 70 分阈值的跳转逻辑。

### 待澄清问题

- 「体态意识训练」是项目内的现有模块吗？(需在后续 Feature 文档中确认)

---

## 规格内容

# Feature Overview

双模式检测系统：基线评估 + 引导改进。

## 模式区分

### 模式1：无引导评估（首次）

- 录制前：仅倒计时
- 录制中：静默（无提示）
- 录制后：分析 → 分数页
- **目的**：获取用户真实基线水平

### 模式2：引导改进（二次录制）

- 录制前：展示要点总结
- 录制中：实时检测 + 语音提示（见 F3）
    - 用户可以选择是否打开语音
- 录制后：对比页

## 分数页结构

### 布局

- 顶部：分数 + 日期
- 中部：问题出现的关键帧截图+骨骼覆盖 + 标注
- 底部：问题卡片列表（动态生成，见 Tone 层）
- 按钮：
    - 「尝试改进」（进入模式2）
    - 「保存打卡图」

### 问题卡片

- 按严重程度排序（红 > 黄）
- 每项包含：问题名称 + 用户理解文案 + 日常影响
- 内容生成规则见 T2 文档

## 打卡图生成

### 触发

点击「保存打卡图」按钮

### 生成内容

- 当前分数页截图（去除底部按钮）
- 叠加元素：Logo + Slogan（右下角）
- 格式：PNG，1080x1920px

### 保存路径

系统相册 + 分享面板

## 路由逻辑

- 分数 ≥ 70：进入引导改进阶段
- 分数 < 70：建议先进行体态意识训练

---

[返回主文档](../../README.md) | [查看实现跟踪](../../implementation-tracking.md)
